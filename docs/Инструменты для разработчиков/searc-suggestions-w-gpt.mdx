---
sidebar_position: 1
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Поисковые подсказки с помощью LLM

В этом руководстве мы рассмотрим подход применения GPT для улучшения конверсии поиска. На AB-тесте внутри Яндекса данный метод показал **увеличение конверсии в покупку в 1.1%**.

## UseCase
Представим, что у нас есть интернет-магазин с широким ассортиментом товаров. Мы хотим увеличить конверсию поиска, чтобы больше людей находили нужные им товары и покупали их. Представим, что пользователь пришел на наш сервис с следущим запросом:

![alt text](/img/ssht.png)

Как мы видим, пользователь не получил никаких подсказок. Давайте попробуем исправить это с помощью GPT.

## Архитектура

1. Пользователь вводит запрос в поисковую строку и ожидает получить k подсказок.
2. Запрос идет в наш сервис поисковых подсказок.
3. Если подсказок нет или меньше k, то мы запрашиваем подсказки у LLM.
4. Доставляем подсказки пользователю.

![alt text](/img/llm-search-suggests-arch.drawio.svg)

## Пример реализации

Попросим модель YandexGPT 4 lite предложить 5 подсказок для запроса "хочу сладкого".

<Tabs>
  <TabItem value="system-prompt" label="Системный промпт" default>
    ````
    Ты - полезный помощник, который формирует поисковые  подсказки на сайте Яндекс Маркет к запросу пользователя. Предложи 5 коротких подсказок, которые могут заинтересовать пользователя. Отвечай только списком строк в формате json, без лишнего текста.

    Например:
    Пользователь:
    хочу снеков
    Ассистент:
    ```
    [
    "чипсы",
    "орешки",
    "сухарики",
    "попкорн",
    "вяленые томаты"
    ]
    ```
    ````
  </TabItem>
  <TabItem value="user-prompt" label="Пользовательский промпт">
    ```
    хочу сладкого
    ```
  </TabItem>
  <TabItem value="model-answer" label="Ответ модели">
    ````
    ```
    [
    "шоколад",
    "конфеты",
    "печенье",
    "торты",
    "мармелад"
    ]
    ```
    ````
  </TabItem>
</Tabs>

Отлично! Теперь мы можем отобразить пользователю подсказки.

![alt text](/img/search-suggests-success.png)

Также можно попробовать применить следующие оптимизации:

- Для уменьшения количества запросов к LLM можно кэшировать запросы
- Для повышения "необычности" подсказок можно использовать температуру 0.7-0.9
- Подсказки, сгенерированные LLM, можно дополнительно визуально отображать пользователю как нейросетевые